import{u as e,j as s,L as r}from"./index-b7c13edd.js";import{r as t}from"./vendor-0a74ad82.js";import"./firebase-d00d8d06.js";import{r as a}from"./recordingService-ad327dd0.js";import{B as l}from"./Button-1fec977d.js";import{C as d}from"./CreateRecordingModal-b8399fc3.js";import{u as i}from"./useTranslation-40d56fa6.js";import{P as n,V as c,j as o,a as x,C as g,n as m,o as h,l as u,p as j,q as p}from"./ui-5d9f441a.js";import"./router-80e9042b.js";import"./utils-a27d9a93.js";import"./index.esm-e04fd8e7.js";import"./Select-21fe8f27.js";import"./utils-db1934d6.js";const b=()=>{i();const{user:b}=e(),[y,f]=t.useState([]),[w,N]=t.useState(!0),[v,k]=t.useState(""),[S,C]=t.useState("all"),[M,P]=t.useState(!1),[B,L]=t.useState({}),R=b?.uid;t.useEffect(()=>{R&&$()},[R]);const $=async()=>{try{N(!0);const e=(await a.getAllRecordings()).filter(e=>e.teacherId===R||e.createdBy===R);f(e)}catch(e){}finally{N(!1)}},z=y.filter(e=>{const s=e.title?.toLowerCase().includes(v.toLowerCase())||e.description?.toLowerCase().includes(v.toLowerCase())||e.tags?.some(e=>e.toLowerCase().includes(v.toLowerCase())),r="all"===S||e.status===S||"published"===S&&e.isPublished||"unpublished"===S&&!e.isPublished;return s&&r}),A=e=>{switch(e){case"completed":return"from-green-500 to-emerald-500";case"recording":return"from-blue-500 to-cyan-500";case"processing":return"from-yellow-500 to-orange-500";case"failed":return"from-red-500 to-pink-500";default:return"from-gray-500 to-gray-600"}},T=e=>{if(!e)return"0:00";const s=Math.floor(e/3600),r=Math.floor(e%3600/60),t=Math.floor(e%60);return s>0?`${s}:${r.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`:`${r}:${t.toString().padStart(2,"0")}`},F=e=>{if(!e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,s)*100)/100+" "+["B","KB","MB","GB"][s]};return w?s.jsx("div",{className:"flex items-center justify-center min-h-96",children:s.jsx(r,{size:"lg"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Recordings"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage and publish your recording sessions"})]}),s.jsxs(l,{onClick:()=>P(!0),className:"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600",children:[s.jsx(n,{className:"h-4 w-4 mr-2"}),"New Recording"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y.length})]}),s.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:s.jsx(c,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Published"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y.filter(e=>e.isPublished).length})]}),s.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:s.jsx(o,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Views"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y.reduce((e,s)=>e+(s.views||0),0)})]}),s.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:s.jsx(x,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"In Progress"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y.filter(e=>"recording"===e.status||"processing"===e.status).length})]}),s.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg",children:s.jsx(g,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400"})})]})})]}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-4 lg:space-y-0 lg:space-x-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search recordings...",value:v,onChange:e=>k(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsxs("select",{value:S,onChange:e=>C(e.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"published",children:"Published"}),s.jsx("option",{value:"unpublished",children:"Unpublished"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"recording",children:"Recording"}),s.jsx("option",{value:"processing",children:"Processing"}),s.jsx("option",{value:"failed",children:"Failed"})]}),s.jsxs(l,{variant:"outline",children:[s.jsx(h,{className:"h-4 w-4 mr-2"}),"Filters"]})]})]})}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:z.map(e=>{const r=(e=>{switch(e){case"completed":return o;case"recording":return u;case"processing":return g;case"failed":return j;default:return c}})(e.status);return s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-xl transition-all duration-300",children:[s.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg line-clamp-2",children:e.title}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1 line-clamp-2",children:e.description||"No description provided"})]}),s.jsx("div",{className:`ml-3 p-2 rounded-lg bg-gradient-to-br ${A(e.status)}`,children:s.jsx(r,{className:"h-4 w-4 text-white"})})]}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400",children:[s.jsxs("span",{className:"flex items-center",children:[s.jsx(x,{className:"h-4 w-4 mr-1"}),e.views||0," views"]}),s.jsxs("span",{className:"flex items-center",children:[s.jsx(g,{className:"h-4 w-4 mr-1"}),T(e.duration)]}),e.isPublished&&s.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 rounded-full text-xs",children:"Published"})]})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"File Size"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:F(e.fileSize)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Created"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:new Date(e.createdAt).toLocaleDateString()})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Status"}),s.jsx("span",{className:"text-sm font-medium capitalize "+("completed"===e.status?"text-green-600 dark:text-green-400":"recording"===e.status?"text-blue-600 dark:text-blue-400":"processing"===e.status?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"),children:e.status})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[e.recordingUrl&&s.jsx("a",{href:e.recordingUrl,target:"_blank",rel:"noopener noreferrer",className:"flex-1",children:s.jsxs(l,{className:"w-full",children:[s.jsx(u,{className:"h-4 w-4 mr-2"}),"Watch"]})}),e.isPublished?s.jsx(l,{variant:"outline",onClick:()=>(async e=>{try{L(s=>({...s,[e]:!0})),await a.unpublishRecording(e),await $()}catch(s){}finally{L(s=>({...s,[e]:!1}))}})(e.id),disabled:B[e.id],children:s.jsx(j,{className:"h-4 w-4"})}):s.jsx(l,{onClick:()=>(async e=>{try{L(s=>({...s,[e]:!0})),await a.publishRecording(e),await $()}catch(s){}finally{L(s=>({...s,[e]:!1}))}})(e.id),disabled:B[e.id],children:s.jsx(o,{className:"h-4 w-4"})}),s.jsx(l,{variant:"outline",size:"sm",children:s.jsx(p,{className:"h-4 w-4"})})]})]})]},e.id)})}),0===z.length&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(c,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No recordings found"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:v||"all"!==S?"Try adjusting your search or filters":"Get started by creating your first recording"}),s.jsxs(l,{onClick:()=>P(!0),className:"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600",children:[s.jsx(n,{className:"h-4 w-4 mr-2"}),"Create Recording"]})]}),M&&s.jsx(d,{onClose:()=>P(!1),onSuccess:()=>{P(!1),$()}})]})};export{b as default};
