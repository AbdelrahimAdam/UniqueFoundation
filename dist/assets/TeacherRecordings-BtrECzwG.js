var e=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(r,s,t)=>s in r?e(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t,d=(e,r)=>{for(var s in r||(r={}))a.call(r,s)&&i(e,s,r[s]);if(t)for(var s of t(r))l.call(r,s)&&i(e,s,r[s]);return e},n=(e,t)=>r(e,s(t));import{u as c,j as o,L as x}from"./index-CI4zpFZI.js";import{r as g}from"./router-C3Im-STG.js";import"./firebase-BFqJWPH6.js";import{r as m}from"./recordingService-DLOKybmB.js";import{B as h}from"./Button-ye-G-80u.js";import{C as u}from"./CreateRecordingModal-Bt7Etmob.js";import{u as p}from"./useTranslation-D7bftQm-.js";import{P as j,V as b,n as y,a as f,C as w,k as N,l as v,m as k,p as S,q as C}from"./ui-BAjx5vmw.js";import"./vendor-BhyxaAfg.js";import"./utils-nJVaOoPq.js";import"./index.esm-Vr2sJyeS.js";import"./Select-BXp-jGT8.js";import"./utils-FV6rFRcL.js";const P=()=>{const{t:e}=p(),{user:r}=c(),[s,t]=g.useState([]),[a,l]=g.useState(!0),[i,P]=g.useState(""),[M,B]=g.useState("all"),[O,L]=g.useState(!1),[R,$]=g.useState({}),z=null==r?void 0:r.uid;g.useEffect(()=>{z&&A()},[z]);const A=async()=>{try{l(!0);const e=(await m.getAllRecordings()).filter(e=>e.teacherId===z||e.createdBy===z);t(e)}catch(e){}finally{l(!1)}},T=s.filter(e=>{var r,s,t;const a=(null==(r=e.title)?void 0:r.toLowerCase().includes(i.toLowerCase()))||(null==(s=e.description)?void 0:s.toLowerCase().includes(i.toLowerCase()))||(null==(t=e.tags)?void 0:t.some(e=>e.toLowerCase().includes(i.toLowerCase()))),l="all"===M||e.status===M||"published"===M&&e.isPublished||"unpublished"===M&&!e.isPublished;return a&&l}),D=e=>{switch(e){case"completed":return"from-green-500 to-emerald-500";case"recording":return"from-blue-500 to-cyan-500";case"processing":return"from-yellow-500 to-orange-500";case"failed":return"from-red-500 to-pink-500";default:return"from-gray-500 to-gray-600"}},F=e=>{if(!e)return"0:00";const r=Math.floor(e/3600),s=Math.floor(e%3600/60),t=Math.floor(e%60);return r>0?`${r}:${s.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`:`${s}:${t.toString().padStart(2,"0")}`},I=e=>{if(!e)return"0 B";const r=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,r)*100)/100+" "+["B","KB","MB","GB"][r]};return a?o.jsx("div",{className:"flex items-center justify-center min-h-96",children:o.jsx(x,{size:"lg"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Recordings"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage and publish your recording sessions"})]}),o.jsxs(h,{onClick:()=>L(!0),className:"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600",children:[o.jsx(j,{className:"h-4 w-4 mr-2"}),"New Recording"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.length})]}),o.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:o.jsx(b,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})})]})}),o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Published"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.filter(e=>e.isPublished).length})]}),o.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:o.jsx(y,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]})}),o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Views"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.reduce((e,r)=>e+(r.views||0),0)})]}),o.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:o.jsx(f,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]})}),o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"In Progress"}),o.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.filter(e=>"recording"===e.status||"processing"===e.status).length})]}),o.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg",children:o.jsx(w,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400"})})]})})]}),o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-4 lg:space-y-0 lg:space-x-4",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"relative",children:[o.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search recordings...",value:i,onChange:e=>P(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsxs("select",{value:M,onChange:e=>B(e.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"all",children:"All Status"}),o.jsx("option",{value:"published",children:"Published"}),o.jsx("option",{value:"unpublished",children:"Unpublished"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"recording",children:"Recording"}),o.jsx("option",{value:"processing",children:"Processing"}),o.jsx("option",{value:"failed",children:"Failed"})]}),o.jsxs(h,{variant:"outline",children:[o.jsx(v,{className:"h-4 w-4 mr-2"}),"Filters"]})]})]})}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:T.map(e=>{const r=(e=>{switch(e){case"completed":return y;case"recording":return k;case"processing":return w;case"failed":return S;default:return b}})(e.status);return o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-xl transition-all duration-300",children:[o.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg line-clamp-2",children:e.title}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1 line-clamp-2",children:e.description||"No description provided"})]}),o.jsx("div",{className:`ml-3 p-2 rounded-lg bg-gradient-to-br ${D(e.status)}`,children:o.jsx(r,{className:"h-4 w-4 text-white"})})]}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400",children:[o.jsxs("span",{className:"flex items-center",children:[o.jsx(f,{className:"h-4 w-4 mr-1"}),e.views||0," views"]}),o.jsxs("span",{className:"flex items-center",children:[o.jsx(w,{className:"h-4 w-4 mr-1"}),F(e.duration)]}),e.isPublished&&o.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 rounded-full text-xs",children:"Published"})]})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"space-y-3 mb-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"File Size"}),o.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:I(e.fileSize)})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Created"}),o.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:new Date(e.createdAt).toLocaleDateString()})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Status"}),o.jsx("span",{className:"text-sm font-medium capitalize "+("completed"===e.status?"text-green-600 dark:text-green-400":"recording"===e.status?"text-blue-600 dark:text-blue-400":"processing"===e.status?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"),children:e.status})]})]}),o.jsxs("div",{className:"flex space-x-2",children:[e.recordingUrl&&o.jsx("a",{href:e.recordingUrl,target:"_blank",rel:"noopener noreferrer",className:"flex-1",children:o.jsxs(h,{className:"w-full",children:[o.jsx(k,{className:"h-4 w-4 mr-2"}),"Watch"]})}),e.isPublished?o.jsx(h,{variant:"outline",onClick:()=>(async e=>{try{$(r=>n(d({},r),{[e]:!0})),await m.unpublishRecording(e),await A()}catch(r){}finally{$(r=>n(d({},r),{[e]:!1}))}})(e.id),disabled:R[e.id],children:o.jsx(S,{className:"h-4 w-4"})}):o.jsx(h,{onClick:()=>(async e=>{try{$(r=>n(d({},r),{[e]:!0})),await m.publishRecording(e),await A()}catch(r){}finally{$(r=>n(d({},r),{[e]:!1}))}})(e.id),disabled:R[e.id],children:o.jsx(y,{className:"h-4 w-4"})}),o.jsx(h,{variant:"outline",size:"sm",children:o.jsx(C,{className:"h-4 w-4"})})]})]})]},e.id)})}),0===T.length&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(b,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No recordings found"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:i||"all"!==M?"Try adjusting your search or filters":"Get started by creating your first recording"}),o.jsxs(h,{onClick:()=>L(!0),className:"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600",children:[o.jsx(j,{className:"h-4 w-4 mr-2"}),"Create Recording"]})]}),O&&o.jsx(u,{onClose:()=>L(!1),onSuccess:()=>{L(!1),A()}})]})};export{P as default};
