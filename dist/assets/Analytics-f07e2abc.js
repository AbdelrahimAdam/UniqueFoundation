import{e,r as s,j as t,D as r,l as a,m as l,V as d,n as i,C as n,g as x,a0 as c,T as o,a1 as m}from"./vendor-react-b59152ff.js";import{u as g}from"./userService-3683d387.js";import{s as h}from"./sessionService-cec466cd.js";import{r as j}from"./recordingService-f09f52a5.js";import{c as u}from"./courseService-97d71fc9.js";import{B as y}from"./Button-d86c7bdc.js";import{L as b}from"./index-cde8ec3e.js";import"./vendor-c2e5c299.js";import"./firebase-a4f86f3d.js";import"./i18n-417c627b.js";const p=()=>{var p,f,N;e();const[w,v]=s.useState({}),[k,S]=s.useState("30days"),[A,M]=s.useState(!0);s.useEffect(()=>{D()},[k]);const D=async()=>{try{M(!0);const[e,s,t,r]=await Promise.all([g.getAllUsers(),u.getAllCourses(),h.getAllSessions(),j.getAllRecordings()]),a=new Date,l={"7days":6048e5,"30days":2592e6,"90days":7776e6}[k],d=e.filter(e=>e.createdAt&&a-new Date(e.createdAt)<l),i=t.filter(e=>e.createdAt&&a-new Date(e.createdAt)<l),n=r.reduce((e,s)=>e+(s.duration||0),0),x=r.reduce((e,s)=>e+(s.fileSize||0),0);v({totalUsers:e.length,totalCourses:s.length,totalSessions:t.length,totalRecordings:r.length,newUsers:d.length,activeSessions:t.filter(e=>"live"===e.status).length,completedSessions:t.filter(e=>"completed"===e.status).length,totalWatchTime:n,storageUsed:x,userGrowth:d.length,sessionGrowth:i.length,userDistribution:{students:e.filter(e=>"student"===e.role).length,teachers:e.filter(e=>"teacher"===e.role).length,admins:e.filter(e=>"admin"===e.role).length}})}catch(e){}finally{M(!1)}},T=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString();return A?t.jsx("div",{className:"flex items-center justify-center min-h-96",children:t.jsx(b,{size:"lg"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Platform Analytics"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Detailed insights and platform metrics"})]}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsxs("select",{value:k,onChange:e=>S(e.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"7days",children:"Last 7 days"}),t.jsx("option",{value:"30days",children:"Last 30 days"}),t.jsx("option",{value:"90days",children:"Last 90 days"})]}),t.jsxs(y,{variant:"outline",children:[t.jsx(r,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Users"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T(w.totalUsers)}),t.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:["+",w.userGrowth," new"]})]}),t.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:t.jsx(a,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Courses"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T(w.totalCourses)}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Active learning"})]}),t.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:t.jsx(l,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Sessions"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T(w.totalSessions)}),t.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:[w.activeSessions," live"]})]}),t.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:t.jsx(d,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Storage Used"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(e=>{if(!e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,s)*100)/100+" "+["B","KB","MB","GB"][s]})(1024*w.storageUsed*1024)}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Recordings & files"})]}),t.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:t.jsx(i,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"User Distribution"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Students"})]}),t.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(null==(p=w.userDistribution)?void 0:p.students)||0})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Teachers"})]}),t.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(null==(f=w.userDistribution)?void 0:f.teachers)||0})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Admins"})]}),t.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(null==(N=w.userDistribution)?void 0:N.admins)||0})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Session Analytics"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(n,{className:"h-4 w-4 text-blue-500"}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Watch Time"})]}),t.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(e=>{if(!e)return"0:00";return`${Math.floor(e/3600)}h ${Math.floor(e%3600/60)}m`})(w.totalWatchTime)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(d,{className:"h-4 w-4 text-green-500"}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed Sessions"})]}),t.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:w.completedSessions})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(x,{className:"h-4 w-4 text-purple-500"}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Recordings"})]}),t.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:w.totalRecordings})]})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:["Growth Metrics (",k.replace("days"," days"),")"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-3",children:t.jsx(c,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),t.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["+",w.userGrowth]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"New Users"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-3",children:t.jsx(o,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"})}),t.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["+",w.sessionGrowth]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"New Sessions"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center mx-auto mb-3",children:t.jsx(m,{className:"h-8 w-8 text-purple-600 dark:text-purple-400"})}),t.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[Math.round(w.completedSessions/Math.max(w.totalSessions,1)*100),"%"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completion Rate"})]})]})]})]})};export{p as default};
