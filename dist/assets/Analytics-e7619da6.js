import{j as e,L as s}from"./index-c63f14c2.js";import{r as t}from"./vendor-c3615fdd.js";import{u as r}from"./userService-2e30986f.js";import{s as a}from"./sessionService-69fc7e03.js";import{r as l}from"./recordingService-265d9a9f.js";import{c as d}from"./courseService-fdde1342.js";import{B as i}from"./Button-4635154f.js";import{u as n}from"./useTranslation-89f0f982.js";import{D as x,b as c,B as o,V as m,c as g,C as h,a as j,t as u,T as b,u as y}from"./ui-e3d8d230.js";import"./router-4adec120.js";import"./firebase-9a5fb30d.js";import"./utils-5b9d0682.js";const p=()=>{var p,f,N;n();const[w,v]=t.useState({}),[k,S]=t.useState("30days"),[A,M]=t.useState(!0);t.useEffect(()=>{T()},[k]);const T=async()=>{try{M(!0);const[e,s,t,i]=await Promise.all([r.getAllUsers(),d.getAllCourses(),a.getAllSessions(),l.getAllRecordings()]),n=new Date,x={"7days":6048e5,"30days":2592e6,"90days":7776e6}[k],c=e.filter(e=>e.createdAt&&n-new Date(e.createdAt)<x),o=t.filter(e=>e.createdAt&&n-new Date(e.createdAt)<x),m=i.reduce((e,s)=>e+(s.duration||0),0),g=i.reduce((e,s)=>e+(s.fileSize||0),0);v({totalUsers:e.length,totalCourses:s.length,totalSessions:t.length,totalRecordings:i.length,newUsers:c.length,activeSessions:t.filter(e=>"live"===e.status).length,completedSessions:t.filter(e=>"completed"===e.status).length,totalWatchTime:m,storageUsed:g,userGrowth:c.length,sessionGrowth:o.length,userDistribution:{students:e.filter(e=>"student"===e.role).length,teachers:e.filter(e=>"teacher"===e.role).length,admins:e.filter(e=>"admin"===e.role).length}})}catch(e){}finally{M(!1)}},D=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString();return A?e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsx(s,{size:"lg"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Platform Analytics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Detailed insights and platform metrics"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("select",{value:k,onChange:e=>S(e.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"7days",children:"Last 7 days"}),e.jsx("option",{value:"30days",children:"Last 30 days"}),e.jsx("option",{value:"90days",children:"Last 90 days"})]}),e.jsxs(i,{variant:"outline",children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:D(w.totalUsers)}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:["+",w.userGrowth," new"]})]}),e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.jsx(c,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Courses"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:D(w.totalCourses)}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Active learning"})]}),e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(o,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:D(w.totalSessions)}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:[w.activeSessions," live"]})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(m,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Storage Used"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(e=>{if(!e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,s)*100)/100+" "+["B","KB","MB","GB"][s]})(1024*w.storageUsed*1024)}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Recordings & files"})]}),e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(g,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"User Distribution"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Students"})]}),e.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(null==(p=w.userDistribution)?void 0:p.students)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Teachers"})]}),e.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(null==(f=w.userDistribution)?void 0:f.teachers)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Admins"})]}),e.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(null==(N=w.userDistribution)?void 0:N.admins)||0})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Session Analytics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(h,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Watch Time"})]}),e.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(e=>{if(!e)return"0:00";return`${Math.floor(e/3600)}h ${Math.floor(e%3600/60)}m`})(w.totalWatchTime)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(m,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed Sessions"})]}),e.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:w.completedSessions})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(j,{className:"h-4 w-4 text-purple-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Recordings"})]}),e.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:w.totalRecordings})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:["Growth Metrics (",k.replace("days"," days"),")"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(u,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["+",w.userGrowth]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"New Users"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(b,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"})}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["+",w.sessionGrowth]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"New Sessions"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(y,{className:"h-8 w-8 text-purple-600 dark:text-purple-400"})}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[Math.round(w.completedSessions/Math.max(w.totalSessions,1)*100),"%"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completion Rate"})]})]})]})]})};export{p as default};
