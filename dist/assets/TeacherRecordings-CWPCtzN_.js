var e=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,d=(r,s,t)=>s in r?e(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t,i=(e,r)=>{for(var s in r||(r={}))a.call(r,s)&&d(e,s,r[s]);if(t)for(var s of t(r))l.call(r,s)&&d(e,s,r[s]);return e},n=(e,t)=>r(e,s(t));import{e as c,r as o,j as x,P as g,V as m,K as h,g as u,C as b,H as p,I as j,J as y,W as f,Y as w}from"./vendor-react-UVl3l3eP.js";import{u as N,L as v}from"./index-DEgoYGZl.js";import"./firebase-DbUGxvwD.js";import{r as k}from"./recordingService-DCQSlFNV.js";import{B as S}from"./Button-BII5FLFC.js";import{C}from"./CreateRecordingModal-2wDhSN1Z.js";import"./vendor-BMEBppWF.js";import"./i18n-CsgR-yW4.js";import"./Select-DqBXF94C.js";const P=()=>{const{t:e}=c(),{user:r}=N(),[s,t]=o.useState([]),[a,l]=o.useState(!0),[d,P]=o.useState(""),[M,O]=o.useState("all"),[B,L]=o.useState(!1),[R,$]=o.useState({}),z=null==r?void 0:r.uid;o.useEffect(()=>{z&&I()},[z]);const I=async()=>{try{l(!0);const e=(await k.getAllRecordings()).filter(e=>e.teacherId===z||e.createdBy===z);t(e)}catch(e){}finally{l(!1)}},A=s.filter(e=>{var r,s,t;const a=(null==(r=e.title)?void 0:r.toLowerCase().includes(d.toLowerCase()))||(null==(s=e.description)?void 0:s.toLowerCase().includes(d.toLowerCase()))||(null==(t=e.tags)?void 0:t.some(e=>e.toLowerCase().includes(d.toLowerCase()))),l="all"===M||e.status===M||"published"===M&&e.isPublished||"unpublished"===M&&!e.isPublished;return a&&l}),D=e=>{switch(e){case"completed":return"from-green-500 to-emerald-500";case"recording":return"from-blue-500 to-cyan-500";case"processing":return"from-yellow-500 to-orange-500";case"failed":return"from-red-500 to-pink-500";default:return"from-gray-500 to-gray-600"}},F=e=>{if(!e)return"0:00";const r=Math.floor(e/3600),s=Math.floor(e%3600/60),t=Math.floor(e%60);return r>0?`${r}:${s.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`:`${s}:${t.toString().padStart(2,"0")}`},T=e=>{if(!e)return"0 B";const r=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,r)*100)/100+" "+["B","KB","MB","GB"][r]};return a?x.jsx("div",{className:"flex items-center justify-center min-h-96",children:x.jsx(v,{size:"lg"})}):x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Recordings"}),x.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage and publish your recording sessions"})]}),x.jsxs(S,{onClick:()=>L(!0),className:"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600",children:[x.jsx(g,{className:"h-4 w-4 mr-2"}),"New Recording"]})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total"}),x.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.length})]}),x.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:x.jsx(m,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Published"}),x.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.filter(e=>e.isPublished).length})]}),x.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:x.jsx(h,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Views"}),x.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.reduce((e,r)=>e+(r.views||0),0)})]}),x.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:x.jsx(u,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"In Progress"}),x.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.filter(e=>"recording"===e.status||"processing"===e.status).length})]}),x.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg",children:x.jsx(b,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400"})})]})})]}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700",children:x.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-4 lg:space-y-0 lg:space-x-4",children:[x.jsx("div",{className:"flex-1",children:x.jsxs("div",{className:"relative",children:[x.jsx(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),x.jsx("input",{type:"text",placeholder:"Search recordings...",value:d,onChange:e=>P(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),x.jsxs("div",{className:"flex space-x-4",children:[x.jsxs("select",{value:M,onChange:e=>O(e.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[x.jsx("option",{value:"all",children:"All Status"}),x.jsx("option",{value:"published",children:"Published"}),x.jsx("option",{value:"unpublished",children:"Unpublished"}),x.jsx("option",{value:"completed",children:"Completed"}),x.jsx("option",{value:"recording",children:"Recording"}),x.jsx("option",{value:"processing",children:"Processing"}),x.jsx("option",{value:"failed",children:"Failed"})]}),x.jsxs(S,{variant:"outline",children:[x.jsx(j,{className:"h-4 w-4 mr-2"}),"Filters"]})]})]})}),x.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:A.map(e=>{const r=(e=>{switch(e){case"completed":return h;case"recording":return y;case"processing":return b;case"failed":return f;default:return m}})(e.status);return x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-xl transition-all duration-300",children:[x.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[x.jsxs("div",{className:"flex items-start justify-between mb-3",children:[x.jsxs("div",{className:"flex-1",children:[x.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg line-clamp-2",children:e.title}),x.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1 line-clamp-2",children:e.description||"No description provided"})]}),x.jsx("div",{className:`ml-3 p-2 rounded-lg bg-gradient-to-br ${D(e.status)}`,children:x.jsx(r,{className:"h-4 w-4 text-white"})})]}),x.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400",children:[x.jsxs("span",{className:"flex items-center",children:[x.jsx(u,{className:"h-4 w-4 mr-1"}),e.views||0," views"]}),x.jsxs("span",{className:"flex items-center",children:[x.jsx(b,{className:"h-4 w-4 mr-1"}),F(e.duration)]}),e.isPublished&&x.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 rounded-full text-xs",children:"Published"})]})]}),x.jsxs("div",{className:"p-6",children:[x.jsxs("div",{className:"space-y-3 mb-4",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"File Size"}),x.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:T(e.fileSize)})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Created"}),x.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:new Date(e.createdAt).toLocaleDateString()})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Status"}),x.jsx("span",{className:"text-sm font-medium capitalize "+("completed"===e.status?"text-green-600 dark:text-green-400":"recording"===e.status?"text-blue-600 dark:text-blue-400":"processing"===e.status?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"),children:e.status})]})]}),x.jsxs("div",{className:"flex space-x-2",children:[e.recordingUrl&&x.jsx("a",{href:e.recordingUrl,target:"_blank",rel:"noopener noreferrer",className:"flex-1",children:x.jsxs(S,{className:"w-full",children:[x.jsx(y,{className:"h-4 w-4 mr-2"}),"Watch"]})}),e.isPublished?x.jsx(S,{variant:"outline",onClick:()=>(async e=>{try{$(r=>n(i({},r),{[e]:!0})),await k.unpublishRecording(e),await I()}catch(r){}finally{$(r=>n(i({},r),{[e]:!1}))}})(e.id),disabled:R[e.id],children:x.jsx(f,{className:"h-4 w-4"})}):x.jsx(S,{onClick:()=>(async e=>{try{$(r=>n(i({},r),{[e]:!0})),await k.publishRecording(e),await I()}catch(r){}finally{$(r=>n(i({},r),{[e]:!1}))}})(e.id),disabled:R[e.id],children:x.jsx(h,{className:"h-4 w-4"})}),x.jsx(S,{variant:"outline",size:"sm",children:x.jsx(w,{className:"h-4 w-4"})})]})]})]},e.id)})}),0===A.length&&x.jsxs("div",{className:"text-center py-12",children:[x.jsx(m,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),x.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No recordings found"}),x.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:d||"all"!==M?"Try adjusting your search or filters":"Get started by creating your first recording"}),x.jsxs(S,{onClick:()=>L(!0),className:"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600",children:[x.jsx(g,{className:"h-4 w-4 mr-2"}),"Create Recording"]})]}),B&&x.jsx(C,{onClose:()=>L(!1),onSuccess:()=>{L(!1),I()}})]})};export{P as default};
