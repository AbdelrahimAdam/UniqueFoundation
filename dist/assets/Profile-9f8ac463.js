import{u as e,d as s,j as a}from"./index-ce15b861.js";import{r}from"./vendor-0a74ad82.js";import{A as t,B as l,D as o,G as i,W as d,X as n,Y as c}from"./firebase-383b8577.js";import{c as m,B as u}from"./Button-fb358952.js";import{I as x}from"./Input-6b5525f6.js";import{u as p}from"./useTranslation-9d3f62b5.js";import{C as h}from"./camera-0148ccce.js";import{C as g}from"./calendar-9dea7464.js";import{S as b,U as f,G as y}from"./user-check-0ed7f803.js";import{U as j}from"./users-1bfd9ab7.js";import{B as w}from"./book-open-4dbb8b42.js";import{S as N}from"./settings-6d782a8d.js";import{C as v}from"./clock-5d166213.js";import{A as k}from"./award-fb2edfcc.js";import{T as P}from"./trending-up-4b199bbc.js";import{U as C}from"./user-1dea5926.js";import{M as z}from"./mail-49d1c0aa.js";import{L as S,E as L}from"./lock-72658cc7.js";import{E as M}from"./eye-ccc819fa.js";import"./router-80e9042b.js";const U=m("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),q=m("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),A=m("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),I=m("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),T=m("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),$=()=>{const{t:m}=p(),{user:$,userProfile:E,updateProfile:R,userRole:B}=e(),[D,F]=r.useState(!1),[G,H]=r.useState(!1),[K,W]=r.useState(!1),[J,O]=r.useState({}),[Q,V]=r.useState("profile"),[X,Y]=r.useState(!1),[Z,_]=r.useState(!1),[ee,se]=r.useState(!1),[ae,re]=r.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[te,le]=r.useState(""),[oe,ie]=r.useState(""),[de,ne]=r.useState(!1),[ce,me]=r.useState({firstName:"",lastName:"",phone:"",address:"",bio:"",department:"",gradeLevel:"",subjects:"",qualifications:""});r.useEffect(()=>{E&&me({firstName:E.firstName||"",lastName:E.lastName||"",phone:E.phone||"",address:E.address||"",bio:E.bio||"",department:E.department||"",gradeLevel:E.gradeLevel||"",subjects:E.subjects||"",qualifications:E.qualifications||""}),ue()},[E,B]);const ue=async()=>{if($)try{let e={};switch(B){case"admin":const a=await t(o(s,"users")),r=await t(o(s,"courses")),d=await t(l(o(s,"users"),i("role","==","teacher")));e={totalUsers:a.size,activeCourses:r.size,teachers:d.size,systemHealth:"98%"};break;case"teacher":const n=await t(l(o(s,"courses"),i("teacherId","==",$.uid))),c=await t(l(o(s,"sessions"),i("teacherId","==",$.uid))),m=await t(l(o(s,"users"),i("role","==","student")));e={totalCourses:n.size,sessions:c.size,students:m.size,rating:"4.8/5"};break;case"student":const u=await t(l(o(s,"enrollments"),i("studentId","==",$.uid))),x=await t(l(o(s,"progress"),i("studentId","==",$.uid),i("completed","==",!0))),p=await t(l(o(s,"sessions"),i("students","array-contains",$.uid)));e={enrolledCourses:u.size,completedLessons:x.size,upcomingSessions:p.size,progress:"75%"};break;default:e={}}O(e)}catch(e){}},xe=e=>{const{name:s,value:a}=e.target;me(e=>({...e,[s]:a}))},pe=e=>{const{name:s,value:a}=e.target;re(e=>({...e,[s]:a})),te&&le(""),oe&&ie("")},he=async()=>{H(!0);try{await R(ce),F(!1)}catch(e){}finally{H(!1)}},ge=async()=>{if(le(""),ie(""),ae.currentPassword&&ae.newPassword&&ae.confirmPassword)if(ae.newPassword.length<6)le(m("profile.passwordMinLength","Password must be at least 6 characters long"));else if(ae.newPassword===ae.confirmPassword)if(ae.newPassword!==ae.currentPassword){ne(!0);try{const e=d.credential($.email,ae.currentPassword);await n($,e),await c($,ae.newPassword),ie(m("profile.passwordChanged","Password changed successfully!")),re({currentPassword:"",newPassword:"",confirmPassword:""})}catch(e){switch(e.code){case"auth/wrong-password":le(m("profile.incorrectPassword","Current password is incorrect"));break;case"auth/weak-password":le(m("profile.weakPassword","Password is too weak. Please use a stronger password."));break;case"auth/requires-recent-login":le(m("profile.recentLoginRequired","Please log in again to change your password"));break;default:le(m("profile.passwordChangeFailed","Failed to change password. Please try again."))}}finally{ne(!1)}}else le(m("profile.samePassword","New password must be different from current password"));else le(m("profile.passwordsDontMatch","New passwords do not match"));else le(m("profile.fillAllFields","Please fill in all fields"))},be=(()=>{const e={admin:{icon:b,color:"purple",badge:m("admin.administrator","Administrator"),stats:[{label:m("admin.totalUsers","Total Users"),value:J.totalUsers||"0",icon:j,color:"text-blue-600"},{label:m("admin.activeCourses","Active Courses"),value:J.activeCourses||"0",icon:w,color:"text-green-600"},{label:m("admin.teachers","Teachers"),value:J.teachers||"0",icon:f,color:"text-purple-600"},{label:m("admin.systemHealth","System Health"),value:J.systemHealth||"100%",icon:N,color:"text-green-600"}]},teacher:{icon:f,color:"blue",badge:m("teacher.teacher","Teacher"),stats:[{label:m("teacher.totalCourses","Total Courses"),value:J.totalCourses||"0",icon:w,color:"text-blue-600"},{label:m("teacher.sessions","Sessions"),value:J.sessions||"0",icon:v,color:"text-green-600"},{label:m("teacher.students","Students"),value:J.students||"0",icon:j,color:"text-purple-600"},{label:m("teacher.rating","Rating"),value:J.rating||"0/5",icon:k,color:"text-yellow-600"}]},student:{icon:y,color:"green",badge:m("student.student","Student"),stats:[{label:m("student.enrolledCourses","Enrolled Courses"),value:J.enrolledCourses||"0",icon:w,color:"text-blue-600"},{label:m("student.completedLessons","Completed Lessons"),value:J.completedLessons||"0",icon:k,color:"text-green-600"},{label:m("student.upcomingSessions","Upcoming Sessions"),value:J.upcomingSessions||"0",icon:v,color:"text-purple-600"},{label:m("student.progress","Overall Progress"),value:J.progress||"0%",icon:P,color:"text-green-600"}]}};return e[B]||e.student})(),fe=be.icon;return a.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:m("profile.title","My Profile")}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:m("profile.description","Manage your profile and account settings")})]}),a.jsx("div",{className:"flex items-center space-x-4",children:a.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-${be.color}-100 text-${be.color}-800 dark:bg-${be.color}-900 dark:text-${be.color}-200`,children:[a.jsx(fe,{className:"w-4 h-4 mr-1"}),be.badge]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:be.stats.map((e,s)=>{const r=e.icon;return a.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-700 dark:to-gray-800 p-6 rounded-xl border border-gray-200 dark:border-gray-600",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:e.label}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:e.value})]}),a.jsx(r,{className:`w-8 h-8 ${e.color}`})]})},s)})}),a.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:a.jsxs("nav",{className:"-mb-px flex space-x-8",children:[a.jsx("button",{onClick:()=>V("profile"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("profile"===Q?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:m("profile.profile","Profile")}),a.jsx("button",{onClick:()=>V("password"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("password"===Q?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:m("profile.password","Password")})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 sticky top-6",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"w-32 h-32 rounded-full border-4 border-white dark:border-gray-700 shadow-lg overflow-hidden",children:[(()=>{const e=E?.photoURL||$?.photoURL;return e?a.jsx("img",{src:e,alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-4 border-white dark:border-gray-700 shadow-lg",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null})(),a.jsx("div",{className:`w-full h-full bg-gradient-to-br ${(()=>{switch(B){case"admin":return"from-purple-500 to-violet-600";case"teacher":return"from-blue-500 to-cyan-600";case"student":return"from-green-500 to-emerald-600";default:return"from-gray-500 to-gray-600"}})()} flex items-center justify-center text-white text-2xl font-bold ${E?.photoURL||$?.photoURL?"hidden":"flex"}`,children:E?.firstName&&E?.lastName?`${E.firstName.charAt(0)}${E.lastName.charAt(0)}`.toUpperCase():$?.email?$.email.charAt(0).toUpperCase():"U"})]}),D&&"profile"===Q&&a.jsxs("label",{className:"absolute bottom-2 right-2 bg-blue-600 p-2 rounded-full cursor-pointer shadow-lg hover:bg-blue-700 transition-colors",children:[K?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsx(h,{size:16,className:"text-white"}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:async e=>{const s=e.target.files[0];if(!s)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(s.type))return void alert("Please select a valid image file (JPEG, PNG, GIF, WebP)");if(s.size>1048576)return void alert("Image size should be less than 1MB for quick upload");W(!0);const a=new FileReader;a.onload=async e=>{try{const s=e.target.result;await R({photoURL:s,photoURLType:"base64"}),alert("Profile picture updated successfully!")}catch(s){alert("Failed to update profile picture. Please try again.")}finally{W(!1)}},a.onerror=()=>{alert("Error reading file. Please try again."),W(!1)},a.readAsDataURL(s)},disabled:K})]})]}),a.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mt-4 text-center",children:[E?.firstName," ",E?.lastName]}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center",children:$?.email}),a.jsx("div",{className:"mt-4 text-center",children:a.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-${be.color}-100 text-${be.color}-800 dark:bg-${be.color}-900 dark:text-${be.color}-200`,children:[a.jsx(fe,{className:"w-4 h-4 mr-1"}),be.badge]})})]}),a.jsxs("div",{className:"mt-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[a.jsx(g,{size:18,className:"mr-3"}),a.jsxs("span",{className:"text-sm",children:[m("profile.memberSince","Member since"),": ",$?.metadata?.creationTime?new Date($.metadata.creationTime).toLocaleDateString():"N/A"]})]}),a.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[a.jsx(A,{size:18,className:"mr-3"}),a.jsx("span",{className:"text-sm",children:ce.address||m("profile.noAddress","No address provided")})]}),a.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[a.jsx(I,{size:18,className:"mr-3"}),a.jsx("span",{className:"text-sm",children:ce.phone||m("profile.noPhone","No phone provided")})]})]})]})}),a.jsxs("div",{className:"lg:col-span-3",children:["profile"===Q&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:m("profile.personalInfo","Personal Information")}),!D&&a.jsx(u,{variant:"outline",onClick:()=>F(!0),children:m("profile.edit","Edit Profile")})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(x,{label:m("profile.firstName","First Name"),name:"firstName",value:ce.firstName,onChange:xe,disabled:!D,icon:a.jsx(C,{size:18,className:"text-gray-400"})}),a.jsx(x,{label:m("profile.lastName","Last Name"),name:"lastName",value:ce.lastName,onChange:xe,disabled:!D})]}),a.jsx(x,{label:m("profile.email","Email Address"),name:"email",value:$?.email||"",disabled:!0,icon:a.jsx(z,{size:18,className:"text-gray-400"})}),a.jsx(x,{label:m("profile.phone","Phone Number"),name:"phone",value:ce.phone,onChange:xe,disabled:!D,icon:a.jsx(I,{size:18,className:"text-gray-400"})}),("admin"===B||"teacher"===B)&&a.jsx(x,{label:m("profile.department","Department"),name:"department",value:ce.department,onChange:xe,disabled:!D,icon:a.jsx(U,{size:18,className:"text-gray-400"})}),"student"===B&&a.jsx(x,{label:m("profile.gradeLevel","Grade Level"),name:"gradeLevel",value:ce.gradeLevel,onChange:xe,disabled:!D,icon:a.jsx(y,{size:18,className:"text-gray-400"})}),"teacher"===B&&a.jsx(x,{label:m("profile.subjects","Subjects"),name:"subjects",value:ce.subjects,onChange:xe,disabled:!D,placeholder:m("profile.subjectsPlaceholder","Math, Science, English..."),icon:a.jsx(w,{size:18,className:"text-gray-400"})}),"teacher"===B&&a.jsx(x,{label:m("profile.qualifications","Qualifications"),name:"qualifications",value:ce.qualifications,onChange:xe,disabled:!D,placeholder:m("profile.qualificationsPlaceholder","M.Ed, PhD, Teaching Certificate..."),icon:a.jsx(k,{size:18,className:"text-gray-400"})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:m("profile.bio","Bio")}),a.jsx("textarea",{name:"bio",value:ce.bio,onChange:xe,disabled:!D,rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white disabled:bg-gray-100 dark:disabled:bg-gray-600 disabled:cursor-not-allowed",placeholder:m("profile.bioPlaceholder","Tell us about yourself...")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:m("profile.address","Address")}),a.jsx("textarea",{name:"address",value:ce.address,onChange:xe,disabled:!D,rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white disabled:bg-gray-100 dark:disabled:bg-gray-600 disabled:cursor-not-allowed",placeholder:m("profile.addressPlaceholder","Enter your address...")})]}),D&&a.jsxs("div",{className:"flex space-x-4 pt-4",children:[a.jsxs(u,{onClick:he,loading:G,className:"flex items-center",children:[a.jsx(T,{size:18,className:"mr-2"}),m("profile.save","Save Changes")]}),a.jsx(u,{variant:"outline",onClick:()=>{F(!1),me({firstName:E?.firstName||"",lastName:E?.lastName||"",phone:E?.phone||"",address:E?.address||"",bio:E?.bio||"",department:E?.department||"",gradeLevel:E?.gradeLevel||"",subjects:E?.subjects||"",qualifications:E?.qualifications||""})},children:m("profile.cancel","Cancel")})]})]})]})}),"password"===Q&&a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:m("profile.changePassword","Change Password")}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:m("profile.passwordSecurity","Update your password to keep your account secure")})]}),te&&a.jsx("div",{className:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:a.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:te})}),oe&&a.jsx("div",{className:"mb-4 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:a.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:oe})}),a.jsxs("div",{className:"space-y-4 max-w-md",children:[a.jsx(x,{label:m("profile.currentPassword","Current Password"),name:"currentPassword",type:X?"text":"password",value:ae.currentPassword,onChange:pe,icon:a.jsx(S,{size:18,className:"text-gray-400"}),trailingIcon:a.jsx("button",{type:"button",onClick:()=>Y(!X),className:"text-gray-400 hover:text-gray-600",children:X?a.jsx(L,{size:18}):a.jsx(M,{size:18})})}),a.jsx(x,{label:m("profile.newPassword","New Password"),name:"newPassword",type:Z?"text":"password",value:ae.newPassword,onChange:pe,icon:a.jsx(q,{size:18,className:"text-gray-400"}),trailingIcon:a.jsx("button",{type:"button",onClick:()=>_(!Z),className:"text-gray-400 hover:text-gray-600",children:Z?a.jsx(L,{size:18}):a.jsx(M,{size:18})})}),a.jsx(x,{label:m("profile.confirmPassword","Confirm New Password"),name:"confirmPassword",type:ee?"text":"password",value:ae.confirmPassword,onChange:pe,icon:a.jsx(q,{size:18,className:"text-gray-400"}),trailingIcon:a.jsx("button",{type:"button",onClick:()=>se(!ee),className:"text-gray-400 hover:text-gray-600",children:ee?a.jsx(L,{size:18}):a.jsx(M,{size:18})})}),a.jsx("div",{className:"pt-4",children:a.jsxs(u,{onClick:ge,loading:de,className:"flex items-center",children:[a.jsx(q,{size:18,className:"mr-2"}),m("profile.updatePassword","Update Password")]})}),a.jsxs("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[a.jsx("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-300 mb-2",children:m("profile.passwordTips","Password Tips")}),a.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-400 space-y-1",children:[a.jsxs("li",{children:["• ",m("profile.minLength","Use at least 6 characters")]}),a.jsxs("li",{children:["• ",m("profile.includeNumbers","Include numbers and symbols")]}),a.jsxs("li",{children:["• ",m("profile.avoidCommon","Avoid common words and patterns")]}),a.jsxs("li",{children:["• ",m("profile.uniquePassword","Use a unique password for this account")]})]})]})]})]})]})]})]})};export{$ as default};
